/* ============================================
   ENGLISH 1 BATAM HUB - STYLES
   Neo-Brutalist Educational Design System
   Refactored: 2025-12-18
   ============================================ */

/* ============================================
   1. DESIGN TOKENS (Variables)
   ============================================ */

:root {
  /* --- Brand Colors --- */
  --color-pink: #FF6B95;
  --color-orange: #FF8C42;
  --color-green: #00E676;
  --color-blue: #2979FF;
  --color-red: #ef4444;
  --color-slate: #64748b;

  /* --- Semantic Theme (Light Mode Default) --- */
  --bg-primary: #F8FAFC;
  --bg-secondary: #FFFFFF;
  --bg-tertiary: #E2E8F0;
  
  --text-primary: #1e293b;
  --text-secondary: #64748b;
  --text-tertiary: #94a3b8;
  
  --border-primary: #1e293b;
  --border-secondary: #cbd5e1;
  --border-danger: #ef4444;
  
  --surface-card: #FFFFFF;
  
  /* --- Visual FX --- */
  --grid-color: #E2E8F0;
  --grid-size: 24px;
  
  --shadow-sm: 2px 2px 0px 0px rgba(30, 41, 59, 1);
  --shadow-md: 4px 4px 0px 0px rgba(30, 41, 59, 1);
  --shadow-lg: 6px 6px 0px 0px rgba(30, 41, 59, 1);
  --shadow-xl: 8px 8px 0px 0px rgba(30, 41, 59, 1);
  
  /* --- Dimensions & Spacing --- */
  --border-thin: 2px;
  --border-med: 3px;
  --border-thick: 4px;
  
  --radius-sm: 0.5rem;
  --radius-md: 0.75rem;
  --radius-lg: 1rem;
  --radius-xl: 1.5rem;
  
  /* --- Animation --- */
  --ease-bounce: cubic-bezier(0.175, 0.885, 0.32, 1.275);
  --ease-smooth: cubic-bezier(0.4, 0, 0.2, 1);
  --trans-fast: 0.1s var(--ease-smooth);
  --trans-base: 0.2s var(--ease-smooth);
  --trans-slow: 0.3s var(--ease-smooth);
  
  /* --- Z-Index Layers --- */
  --z-back: -1;
  --z-base: 0;
  --z-panel: 1;
  --z-elevated: 10;
  --z-overlay: 40;
  --z-modal: 50;
  --z-controls: 60;
  --z-tooltip: 100;
}

/* --- Dark Mode Token Swaps --- */
.dark {
  --bg-primary: #1e293b;
  --bg-secondary: #0f172a;
  --bg-tertiary: #334155;
  
  --text-primary: #f8fafc;
  --text-secondary: #cbd5e1;
  --text-tertiary: #94a3b8;
  
  --border-primary: #94a3b8;
  --border-secondary: #475569;
  --border-danger: #991b1b;
  
  --surface-card: #0f172a;
  --grid-color: #334155;
  
  --shadow-sm: 2px 2px 0px 0px rgba(0, 0, 0, 0.5);
  --shadow-md: 4px 4px 0px 0px rgba(0, 0, 0, 0.5);
  --shadow-lg: 6px 6px 0px 0px rgba(0, 0, 0, 0.5);
  --shadow-xl: 8px 8px 0px 0px rgba(0, 0, 0, 0.5);
}

/* ============================================
   2. BASE & RESET
   ============================================ */

*, *::before, *::after { box-sizing: border-box; }

body {
  font-family: 'Nunito', sans-serif;
  background-color: var(--bg-primary);
  background-image:
    linear-gradient(var(--grid-color) 1px, transparent 1px),
    linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
  background-size: var(--grid-size) var(--grid-size);
  color: var(--text-primary);
  -webkit-tap-highlight-color: transparent;
  overflow-x: hidden;
  transition: background-color var(--trans-slow), color var(--trans-slow);
}

/* ============================================
   3. UTILITIES
   ============================================ */

.sr-only {
  position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px;
  overflow: hidden; clip: rect(0, 0, 0, 0); border-width: 0;
}

/* Custom Scrollbars */
::-webkit-scrollbar { width: 8px; height: 8px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb {
  background: var(--border-secondary);
  border-radius: 4px;
  border: 2px solid transparent;
  background-clip: content-box;
}
::-webkit-scrollbar-thumb:hover { background: var(--text-tertiary); background-clip: content-box; }

/* Focus Ring */
:focus-visible { outline: 3px solid var(--color-blue); outline-offset: 2px; }

/* ============================================
   4. ANIMATIONS
   ============================================ */

@keyframes float { 0% { transform: translate(0, 0) rotate(0deg); } 100% { transform: translate(100px, 100px) rotate(360deg); } }
@keyframes slide-down { from { transform: translateY(-100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
@keyframes slide-in-left { from { opacity: 0; transform: translateX(-20px) scale(0.8); } to { opacity: 1; transform: translateX(0) scale(1); } }
@keyframes pop-in { 0% { opacity: 0; transform: scale(0.95); } 100% { opacity: 1; transform: scale(1); } }
@keyframes spin { to { transform: rotate(360deg); } }
@keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
@keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }

/* ============================================
   5. COMPONENTS
   ============================================ */

/* --- Chunky Buttons --- */
.btn-chunky {
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-family: 'Fredoka', sans-serif;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  border: var(--border-med) solid var(--border-primary);
  box-shadow: 0 4px 0 var(--border-primary);
  cursor: pointer;
  user-select: none;
  transition: all var(--trans-fast);
}

.btn-chunky:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 6px 0 var(--border-primary); }
.btn-chunky:active:not(:disabled) { transform: translateY(4px); box-shadow: 0 0 0 var(--border-primary); }
.btn-chunky:disabled { opacity: 0.5; cursor: not-allowed; }
.btn-chunky.active { background-color: var(--border-primary); color: var(--bg-primary); transform: translateY(4px); box-shadow: none; }

/* --- Hub Cards --- */
.hub-card {
  position: relative;
  display: flex;
  flex-direction: column;
  background: var(--surface-card);
  border: var(--border-thick) solid var(--border-primary);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-lg);
  overflow: hidden;
  cursor: pointer;
  transition: transform var(--trans-fast), box-shadow var(--trans-base);
  transform-style: preserve-3d;
}

.hub-card:hover { z-index: var(--z-elevated); }
.dark .hub-card:hover { filter: brightness(1.05); }

/* --- Inputs --- */
.input-chunky {
  border: var(--border-med) solid var(--border-primary);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-md);
  color: var(--text-primary);
  background-color: var(--bg-secondary);
  transition: all var(--trans-base);
}

.input-chunky:focus { outline: none; transform: translate(2px, 2px); box-shadow: var(--shadow-sm); background-color: var(--bg-primary); }

/* --- Floating Controls (Sticks) --- */
.floating-stick {
  position: absolute;
  top: var(--spacing-sm, 1rem);
  left: var(--spacing-sm, 1rem);
  z-index: var(--z-controls);
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem;
  background: var(--bg-secondary);
  border: var(--border-thick) solid var(--border-primary);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-xl);
  opacity: 0.3;
  transition: opacity var(--trans-slow), transform var(--trans-base);
  animation: slide-down 0.4s var(--ease-bounce);
}

.floating-stick:hover { opacity: 1; }

.stick-btn {
  width: 44px; height: 44px;
  display: flex; align-items: center; justify-content: center;
  background: var(--bg-secondary);
  border: var(--border-med) solid var(--border-primary);
  border-radius: var(--radius-md);
  box-shadow: 0 4px 0 var(--border-primary);
  cursor: pointer;
  transition: all var(--trans-fast);
}

.stick-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 0 var(--border-primary); }
.stick-btn:active { transform: translateY(2px); box-shadow: none; }

/* ============================================
   6. LAYOUT: SIDE PANEL & TABS
   ============================================ */

/* --- Container --- */
#side-panel {
  box-shadow: 4px 0 0 var(--border-primary);
  transition: transform 0.3s var(--trans-smooth);
  width: 5rem; /* Fixed width for calculation in #tab-content-area */
  background: var(--bg-primary);
}
.dark #side-panel { box-shadow: 4px 0 0 rgba(0, 0, 0, 0.5); }
#game-modal.hidden #side-panel { transform: translateX(-100%); }

/* --- Panel Buttons (Common) --- */
.side-panel-btn, .side-panel-tab {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 3.5rem; height: 3.5rem;
  cursor: pointer;
  user-select: none;
  transition: all 0.2s var(--ease-smooth);
}

/* --- Standard Panel Button --- */
.side-panel-btn {
  background: var(--bg-tertiary);
  color: var(--text-secondary);
  border: 3px solid transparent;
  border-radius: 1rem;
}
.side-panel-btn:hover {
  background: var(--bg-secondary);
  border-color: var(--border-secondary);
  transform: translateX(4px) scale(1.05);
  box-shadow: 2px 2px 0 var(--border-primary);
}
.side-panel-btn:active { transform: translateX(2px) scale(1); box-shadow: none; }

/* --- Home Button --- */
.side-panel-home {
  background: var(--color-pink);
  color: white;
  border: 3px solid var(--border-primary); /* Fixed border explicit definition */
  box-shadow: 2px 2px 0 var(--border-primary);
}
.side-panel-home:hover { background: var(--color-orange); transform: translateX(4px) scale(1.1); }

/* --- Danger / Trash Button --- */
.side-panel-danger {
  background: #fee2e2; color: #ef4444; border-color: #ef4444;
}
.dark .side-panel-danger { background: #7f1d1d; color: #fca5a5; border-color: #991b1b; }
.side-panel-danger:hover {
  background: #ef4444; color: white; border-color: #dc2626;
  transform: translateX(4px) scale(1.1);
}

/* --- Tab Items --- */
.side-panel-tab {
  background: var(--bg-tertiary);
  border: 3px solid var(--border-secondary);
  border-radius: 1rem;
  animation: slide-in-left 0.3s var(--ease-bounce);
}
.side-panel-tab:hover {
  transform: translateX(4px) scale(1.05);
  border-color: var(--border-primary);
  box-shadow: 2px 2px 0 var(--border-primary);
}
.side-panel-tab.active {
  border-color: var(--border-primary);
  border-width: 4px;
  box-shadow: 4px 4px 0 var(--border-primary);
  transform: translateX(8px) scale(1.1);
  margin-right: 15px; /* Spacing for active pop-out */
}

/* Tab Colors */
.side-panel-tab[data-color="text-pink"] { background: var(--color-pink); }
.side-panel-tab[data-color="text-orange"] { background: var(--color-orange); }
.side-panel-tab[data-color="text-green"] { background: var(--color-green); }
.side-panel-tab[data-color="text-blue"] { background: var(--color-blue); }
.side-panel-tab[data-color="text-red-500"] { background: var(--color-red); }
.side-panel-tab[data-color="text-slate-500"] { background: var(--color-slate); }

/* Tab Close Button */
.side-panel-tab-close {
  position: absolute; top: -6px; right: -6px;
  display: none; align-items: center; justify-content: center;
  width: 1.25rem; height: 1.25rem;
  background: var(--color-pink); color: white;
  border: 2px solid var(--border-primary); border-radius: 50%;
  cursor: pointer; z-index: 20;
  transition: all 0.15s;
}
.side-panel-tab:hover .side-panel-tab-close { display: flex; }
.side-panel-tab-close:hover { background: var(--color-red); transform: scale(1.2) rotate(90deg); }

/* Tab Loading Spinner */
.side-panel-tab.loading::after {
  content: ''; position: absolute; inset: -3px;
  border: 3px solid transparent; border-top-color: white;
  border-radius: 1rem; animation: spin 1s linear infinite;
}

/* --- Content Areas --- */
#tab-content-area {
  position: relative;
  width: calc(100% - 5rem);
  height: 100vh;
  overflow: hidden;
  background: var(--bg-primary); /* Ensure background matches */
}

.tab-panel, #home-view-panel {
  position: absolute; top: 0; left: 0;
  width: 100%; height: 100%;
  opacity: 0; pointer-events: none;
  transition: opacity 0.3s ease;
  background: var(--bg-primary);
}
.tab-panel iframe, #home-view-panel iframe { width: 100%; height: 100%; border: none; background: white; }

.tab-panel.active, #home-view-panel.active { opacity: 1; pointer-events: auto; z-index: var(--z-panel); }

/* Loading State inside Panel */
.tab-loading {
  position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
  display: flex; flex-direction: column; align-items: center; gap: 1.5rem;
  color: var(--text-primary); font-family: 'Fredoka', sans-serif; z-index: 10;
}
.tab-loading .spinner {
  width: 5rem; height: 5rem;
  border: 5px solid rgba(128, 128, 128, 0.2); border-top-color: var(--color-blue);
  border-radius: 50%; animation: spin 0.8s linear infinite;
}

/* Empty State */
.side-panel-empty {
  position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
  display: flex; flex-direction: column; align-items: center; gap: 1.5rem;
  text-align: center; color: var(--text-tertiary); font-family: 'Fredoka', sans-serif;
  animation: fade-in 0.3s ease;
}
.side-panel-empty i { width: 6rem; height: 6rem; opacity: 0.3; }

/* ============================================
   7. MODALS
   ============================================ */

#confirm-modal {
  backdrop-filter: blur(8px);
  pointer-events: auto;
}
#confirm-modal.hidden { pointer-events: none; }
#confirm-modal .bg-white { animation: pop-in 0.3s var(--ease-bounce); }

/* Max Tabs Warning */
.max-tabs-warning {
  position: fixed; top: 2rem; left: 50%; transform: translateX(-50%);
  padding: 1rem 1.5rem;
  background: var(--color-orange); color: white;
  border: 3px solid var(--border-primary); border-radius: 1rem;
  box-shadow: var(--shadow-lg);
  font-family: 'Fredoka', sans-serif; font-weight: 700;
  z-index: var(--z-tooltip);
  animation: pop-in 0.3s var(--ease-bounce);
}

/* ============================================
   8. BACKGROUND FX
   ============================================ */

.living-bg {
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  z-index: var(--z-back); pointer-events: none; overflow: hidden;
}
.shape {
  position: absolute; opacity: 0.1;
  animation: float 20s infinite linear;
  will-change: transform;
}
.dark .shape { opacity: 0.05; }

/* ============================================
   9. MEDIA QUERIES
   ============================================ */

/* Mobile / Tablet */
@media (max-width: 768px) {
  :root { --grid-size: 20px; }
  
  .hub-card { box-shadow: var(--shadow-md); }
  .btn-chunky { min-height: 44px; padding: 0.75rem 1.5rem; }
  .floating-stick { opacity: 0.9; }
  
  #side-panel { width: 4rem; }
  .side-panel-btn, .side-panel-tab { width: 2.75rem; height: 2.75rem; }
  .side-panel-tab-icon { width: 1.5rem; height: 1.5rem; }
  #tab-content-area { width: calc(100% - 4rem); margin-left: 4rem; }
}

@media (max-width: 640px) {
  :root { --grid-size: 16px; }
  .hub-card { box-shadow: var(--shadow-sm); }
}

/* Reduced Motion */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after { animation-duration: 0.01ms !important; transition-duration: 0.01ms !important; }
}

/* Print */
@media print {
  body { background: white; color: black; background-image: none; }
  .living-bg, .floating-stick, #side-panel { display: none; }
  #tab-content-area { width: 100%; margin-left: 0; }
  .hub-card, .btn-chunky { box-shadow: none; border: 1px solid black; }
}
