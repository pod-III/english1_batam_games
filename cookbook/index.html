<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English 1: Cookbook OS (Chromebook Edition)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        e1pink: '#FF6B95',
                        e1orange: '#FF8C42',
                        e1green: '#00E676',
                        e1blue: '#2979FF',
                        e1dark: '#1e293b',
                        e1chalk: '#f8fafc',
                    },
                    fontFamily: {
                        fredoka: ['Fredoka', 'sans-serif'],
                        nunito: ['Nunito', 'sans-serif'],
                    },
                    boxShadow: {
                        'neo': '4px 4px 0px 0px rgba(30, 41, 59, 1)', /* Tighter shadow for cleaner look */
                        'neo-hover': '6px 6px 0px 0px rgba(30, 41, 59, 1)',
                        'neo-sm': '2px 2px 0px 0px rgba(30, 41, 59, 1)',
                    },
                    animation: {
                        'pop': 'pop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards',
                    },
                    keyframes: {
                        pop: {
                            '0%': { opacity: '0', transform: 'scale(0.95) translateY(10px)' },
                            '100%': { opacity: '1', transform: 'scale(1) translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        /* CHROMEBOOK OPTIMIZED SCROLLBAR */
        body {
            background-color: #f8fafc;
            /* Lighter, subtler grid for better reading contrast */
            background-image: 
                linear-gradient(rgba(30, 41, 59, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(30, 41, 59, 0.05) 1px, transparent 1px);
            background-size: 24px 24px;
        }

        /* Sleek scrollbar for Chrome OS */
        ::-webkit-scrollbar { width: 10px; }
        ::-webkit-scrollbar-track { background: #e2e8f0; }
        ::-webkit-scrollbar-thumb { background: #FF6B95; border-radius: 5px; border: 2px solid #e2e8f0; }
        ::-webkit-scrollbar-thumb:hover { background: #FF8C42; }

        .card-neo { transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.2s; }
        .card-neo:hover { transform: translate(-2px, -2px); box-shadow: 6px 6px 0px 0px rgba(30, 41, 59, 1); }
        
        .btn-neo { transition: transform 0.1s; }
        .btn-neo:active { transform: translate(2px, 2px); box-shadow: 0px 0px 0px 0px rgba(30, 41, 59, 1); }

        .ingredient-check:checked + label { text-decoration: line-through; color: #94a3b8; opacity: 0.6; }
    </style>
</head>
<body class="p-4 md:p-6 lg:p-8 font-nunito text-e1dark min-h-screen flex flex-col items-center">

    <nav class="w-full max-w-7xl mb-6 flex justify-between items-center bg-white border-b-4 border-r-4 border-e1dark rounded-xl p-3 md:p-4 sticky top-2 z-50 shadow-neo-sm">
        <div class="flex items-center gap-3 cursor-pointer group select-none" onclick="renderHome()">
            <div class="bg-e1pink w-10 h-10 border-2 border-e1dark rounded-lg flex items-center justify-center text-white shadow-neo-sm group-hover:rotate-12 transition-transform">
                <i data-lucide="chef-hat" class="w-6 h-6"></i>
            </div>
            <div>
                <h1 class="font-fredoka text-2xl font-bold tracking-tight leading-none text-e1dark">COOKBOOK <span class="text-e1blue">OS</span></h1>
                <span class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">English 1 Batam</span>
            </div>
        </div>
        <button onclick="renderHome()" class="hidden md:flex items-center gap-2 bg-slate-50 hover:bg-white border-2 border-e1dark px-3 py-1.5 rounded-lg font-bold font-fredoka shadow-neo-sm btn-neo text-sm">
            <i data-lucide="layout-grid" class="w-4 h-4 text-e1orange"></i> MENU
        </button>
    </nav>

    <div id="app-container" class="w-full max-w-7xl pb-16">
        <div class="flex flex-col items-center justify-center pt-24 opacity-60">
            <i data-lucide="loader-2" class="animate-spin w-10 h-10 text-e1blue mb-3"></i>
            <h2 class="text-xl font-fredoka font-bold animate-pulse text-slate-400">Loading Kitchen...</h2>
        </div>
    </div>

    <script>
        // --- 9 FULL RECIPES BACKUP (UPDATED) ---
        const BACKUP_RECIPES = [
          { "id": "apple-crumble", "title": "Mini Apple Crumble", "subtitle": "Dessert Mission", "desc": "A lesson in texture. Learn to contrast soft, warm stewed fruit with a crunchy, buttery topping.", "level": "Beginner", "color": "e1pink", "meta": [ { "label": "Prep", "value": "20m", "icon": "clock" }, { "label": "Bake", "value": "180°C", "icon": "flame" }, { "label": "Yield", "value": "1 Cup", "icon": "utensils" } ], "loadout": [ { "groupName": "The Core (Fruit)", "groupColor": "text-e1pink", "items": ["1 Fuji Apple (Firm)", "1 tsp Brown Sugar", "1/4 tsp Cinnamon"] }, { "groupName": "The Armor (Crumble)", "groupColor": "text-e1orange", "items": ["2 Tbsp All-Purpose Flour", "1.5 Tbsp Cold Butter (Cubed)", "1 Tbsp White Sugar", "1 Tbsp Rolled Oats"] } ], "vocab": [ { "word": "Dice (v)", "def": "To cut food into small, precise cubes.", "color": "text-e1pink" }, { "word": "Rub-in (v)", "def": "To incorporate fat into flour using fingertips.", "color": "text-e1orange" }, { "word": "Caramelize (v)", "def": "To cook sugar until it turns brown and nutty.", "color": "text-e1blue" } ], "steps": [ { "number": 1, "title": "Precision Cutting", "color": "e1blue", "desc": "Wash the apple. Slice it into 4 sections around the core. Cut each section into strips, then across into cubes.", "note": "Aim for 1cm cubes for even cooking." }, { "number": 2, "title": "Seasoning", "color": "e1green", "desc": "Place apple cubes in the foil cup. Sprinkle the Brown Sugar and Cinnamon over them.", "note": "Toss gently to coat every cube." }, { "number": 3, "title": "The Sand Texture", "color": "e1orange", "desc": "In a bowl, mix Flour and Sugar. Add Cold Butter. Rub the butter into the flour with your thumbs until it looks like wet beach sand.", "note": "Physics: Friction melts butter, so work fast!", "icon": "zap" }, { "number": 4, "title": "Oats Integration", "color": "e1blue", "desc": "Stir the Rolled Oats into your sandy mixture. Do not rub them in; we want them whole for texture.", "note": "Oats add the 'crunch' factor." }, { "number": 5, "title": "Deployment", "color": "e1pink", "desc": "Pour the crumble mix over the apples. Do not press it down! Let it sit loosely on top to allow steam to escape.", "note": "Bake for 25m until golden brown." } ] },
          { "id": "power-sandwich", "title": "The Power Sandwich", "subtitle": "Lunch Mission", "desc": "The ultimate savory stack. Master the art of layering flavors and frying the perfect egg.", "level": "Intermediate", "color": "e1orange", "meta": [ { "label": "Prep", "value": "10m", "icon": "clock" }, { "label": "Heat", "value": "Medium", "icon": "flame" }, { "label": "Yield", "value": "1 Unit", "icon": "utensils" } ], "loadout": [ { "groupName": "Hardware", "groupColor": "text-e1blue", "items": ["2 Slices Whole Wheat Bread", "1 Slice Cheddar Cheese", "1 Large Egg", "Butter"] }, { "groupName": "Software", "groupColor": "text-e1green", "items": ["Lettuce Leaf (Crisp)", "2 Tomato Slices", "1 tsp Mayo", "Salt & Pepper"] } ], "vocab": [ { "word": "Sizzle (v)", "def": "The hissing sound of food frying in hot oil.", "color": "text-e1orange" }, { "word": "Spatula (n)", "def": "A flat tool used for lifting and flipping.", "color": "text-e1blue" }, { "word": "Assemble (v)", "def": "To fit parts together to build a whole.", "color": "text-e1green" } ], "steps": [ { "number": 1, "title": "Pan Calibration", "color": "e1orange", "desc": "Heat a non-stick pan on medium heat. Add a knob of butter. Wait until it stops foaming—that means it's ready.", "note": "Safety: Keep handle turned inward." }, { "number": 2, "title": "Egg Mechanics", "color": "e1blue", "desc": "Crack the egg gently into the pan. Season with salt immediately. Cook for 2 minutes until the white is solid but yolk is soft.", "note": "Don't break the yolk!" }, { "number": 3, "title": "Toasting (Maillard)", "color": "e1pink", "desc": "While egg cooks, toast your bread slices until golden. Spread mayo on one side of each slice.", "note": "Mayo acts as a moisture barrier." }, { "number": 4, "title": "Logic Stacking", "color": "e1green", "desc": "Order: Bread (Bottom) -> Lettuce -> Tomato -> Egg -> Cheese -> Bread (Top).", "note": "Physics: The hot egg melts the cheese.", "icon": "layers" }, { "number": 5, "title": "The Cross-Cut", "color": "e1orange", "desc": "Press the sandwich down gently with your palm. Use a serrated knife to cut diagonally from corner to corner.", "note": "Triangles taste better than squares." } ] },
          { "id": "tropical-fizz", "title": "Tropical Fizz", "subtitle": "Chemistry Mission", "desc": "A lesson in density and states of matter. Create a refreshing, gradient-colored drink.", "level": "Easy", "color": "e1blue", "meta": [ { "label": "Time", "value": "5m", "icon": "clock" }, { "label": "Fizz", "value": "100%", "icon": "zap" }, { "label": "Yield", "value": "300ml", "icon": "utensils" } ], "loadout": [ { "groupName": "Solvents", "groupColor": "text-e1blue", "items": ["200ml Soda Water (Chilled)", "30ml Orange Syrup"] }, { "groupName": "Solids", "groupColor": "text-e1green", "items": ["1 Cup Ice Cubes", "Mint Leaves", "1 Lemon Wheel"] } ], "vocab": [ { "word": "Carbonation (n)", "def": "Gas bubbles (CO2) dissolved in liquid.", "color": "text-e1blue" }, { "word": "Density (n)", "def": "How heavy a liquid is. Syrup sinks!", "color": "text-e1pink" }, { "word": "Garnish (v)", "def": "To decorate a drink to make it look pro.", "color": "text-e1green" } ], "steps": [ { "number": 1, "title": "Thermal Protection", "color": "e1blue", "desc": "Fill your glass to the very top with ice cubes. Packed ice melts slower, keeping your drink chemically stable (cold).", "note": "Don't use wet hands for ice." }, { "number": 2, "title": "The Heavy Layer", "color": "e1pink", "desc": "Pour the Orange Syrup directly over the ice. Watch it sink to the bottom because it is denser than water.", "note": "Observation: Creates a sunset effect." }, { "number": 3, "title": "Carbon Injection", "color": "e1green", "desc": "Tilt the glass slightly. Pour the Soda Water slowly down the side of the glass to preserve the bubbles.", "note": "Don't pour directly on ice (kills fizz)." }, { "number": 4, "title": "Activation", "color": "e1orange", "desc": "Insert a straw or long spoon. Stir GENTLY only once to mix the gradient slightly.", "note": "Over-stirring causes a flat drink." }, { "number": 5, "title": "Aromatic Garnish", "color": "e1blue", "desc": "Clap the mint leaves between your hands to release oils. Place on top near the straw.", "note": "Smell affects 80% of taste!", "icon": "lightbulb" } ] },
          { "id": "morning-glory-pancakes", "title": "Anti-Gravity Pancakes", "subtitle": "Breakfast Mission", "desc": "Master the viscosity of batter and the timing of the perfect flip. Fluffy and golden.", "level": "Intermediate", "color": "e1green", "meta": [ { "label": "Prep", "value": "15m", "icon": "clock" }, { "label": "Cook", "value": "10m", "icon": "flame" }, { "label": "Yield", "value": "4 Units", "icon": "layers" } ], "loadout": [ { "groupName": "Dry Agents", "groupColor": "text-e1orange", "items": ["1 Cup Flour", "2 tsp Baking Powder", "1 Tbsp Sugar", "Pinch of Salt"] }, { "groupName": "Wet Agents", "groupColor": "text-e1blue", "items": ["1 Cup Milk", "1 Egg", "2 Tbsp Melted Butter", "Vanilla Extract"] } ], "vocab": [ { "word": "Whisk (v)", "def": "To beat mixture quickly to add air.", "color": "text-e1blue" }, { "word": "Batter (n)", "def": "A semi-liquid mixture of flour and milk.", "color": "text-e1orange" }, { "word": "Reaction (n)", "def": "Baking powder creates bubbles when hot.", "color": "text-e1green" } ], "steps": [ { "number": 1, "title": "Dry Team Assembly", "color": "e1orange", "desc": "In a large bowl, whisk together Flour, Baking Powder, Sugar, and Salt. Create a 'well' (hole) in the center.", "note": "Baking powder makes them rise." }, { "number": 2, "title": "Wet Team Assembly", "color": "e1blue", "desc": "In a separate jug, mix Milk, Egg, and Melted Butter. Pour this into the center of the dry bowl.", "note": "Don't scramble the egg in hot butter!" }, { "number": 3, "title": "The Gentle Fold", "color": "e1green", "desc": "Mix until just combined. Lumps are okay! If you over-mix, the pancakes will be tough (gluten formation).", "note": "Stop when flour streaks disappear." }, { "number": 4, "title": "Bubble Indicator", "color": "e1pink", "desc": "Pour ladle of batter onto hot pan. Wait. Do not touch! When bubbles appear on the surface and pop, it is time.", "note": "Bubbles = Structure is set.", "icon": "eye" }, { "number": 5, "title": "The Flip", "color": "e1orange", "desc": "Slide spatula under. Flip with confidence in one motion. Cook 1 more minute on the second side.", "note": "Golden brown is the target." } ] },
          { "id": "code-red-spaghetti", "title": "Code-Red Spaghetti", "subtitle": "Dinner Mission", "desc": "Handle boiling water safely and learn the true meaning of 'Al Dente'.", "level": "Advanced", "color": "e1pink", "meta": [ { "label": "Boil", "value": "10m", "icon": "flame" }, { "label": "Prep", "value": "10m", "icon": "clock" }, { "label": "Yield", "value": "1 Bowl", "icon": "utensils" } ], "loadout": [ { "groupName": "The Carbs", "groupColor": "text-e1orange", "items": ["100g Spaghetti Pasta", "1 Liter Water", "1 Tbsp Salt"] }, { "groupName": "The Sauce", "groupColor": "text-e1pink", "items": ["1/2 Cup Tomato Sauce", "1 tsp Dried Oregano", "Parmesan Cheese", "Basil Leaf"] } ], "vocab": [ { "word": "Al Dente (adj)", "def": "Italian for 'To the tooth'. Firm, not mushy.", "color": "text-e1orange" }, { "word": "Simmer (v)", "def": "To cook gently just below boiling point.", "color": "text-e1pink" }, { "word": "Drain (v)", "def": "To remove water using a colander.", "color": "text-e1blue" } ], "steps": [ { "number": 1, "title": "The Rolling Boil", "color": "e1pink", "desc": "Fill pot with water. Turn heat to High. Wait for big bubbles (Rolling Boil). Add the Salt now.", "note": "Water should taste like the sea." }, { "number": 2, "title": "Pasta Submersion", "color": "e1orange", "desc": "Add spaghetti. As it softens, push it down gently. Stir immediately so it doesn't stick together.", "note": "Don't break the pasta in half!" }, { "number": 3, "title": "The Timing", "color": "e1blue", "desc": "Boil for 9-10 minutes. Taste one strand. It should have a tiny white dot in the center (Al Dente).", "note": "Mushy pasta is a failure." }, { "number": 4, "title": "Sauce Fusion", "color": "e1green", "desc": "Drain water (save a tiny bit!). Return pasta to pot. Pour in Tomato Sauce and Oregano. Mix on low heat for 1 minute.", "note": "The sauce stains clothes—be careful!" }, { "number": 5, "title": "Plating", "color": "e1pink", "desc": "Twist pasta onto plate. Sprinkle heavily with Parmesan Cheese and top with a fresh Basil leaf.", "note": "Chef's Kiss." } ] },
          { "id": "sunny-side-omelette", "title": "The Golden Fold", "subtitle": "Egg Mission", "desc": "Learn temperature control. A fluffy, cheesy omelette that isn't burnt.", "level": "Intermediate", "color": "e1orange", "meta": [ { "label": "Prep", "value": "5m", "icon": "clock" }, { "label": "Cook", "value": "5m", "icon": "flame" }, { "label": "Yield", "value": "1 Unit", "icon": "utensils" } ], "loadout": [ { "groupName": "Base", "groupColor": "text-e1orange", "items": ["2 Large Eggs", "1 Tbsp Milk", "Salt & Pepper"] }, { "groupName": "Fillings", "groupColor": "text-e1green", "items": ["Shredded Cheese", "Diced Ham (Optional)", "Chopped Green Onion"] } ], "vocab": [ { "word": "Whisk (v)", "def": "To mix fast to add air bubbles.", "color": "text-e1blue" }, { "word": "Tilt (v)", "def": "To move the pan so liquid flows.", "color": "text-e1orange" }, { "word": "Fold (v)", "def": "To bend the food over itself.", "color": "text-e1pink" } ], "steps": [ { "number": 1, "title": "Aeration", "color": "e1orange", "desc": "Crack eggs into a bowl. Add Milk, Salt, Pepper. Whisk aggressively until the mixture is uniform yellow and bubbly.", "note": "Air makes it fluffy." }, { "number": 2, "title": "Heat Control", "color": "e1pink", "desc": "Heat pan on Medium-Low. Add butter. If it hisses loudly, it's too hot! Wait for gentle bubbles.", "note": "Burnt eggs taste like rubber." }, { "number": 3, "title": "The Pour & Tilt", "color": "e1blue", "desc": "Pour eggs in. Use spatula to pull cooked edges to center, tilting pan so raw egg flows to the empty spots.", "note": "Keep it moving." }, { "number": 4, "title": "The Filling", "color": "e1green", "desc": "When the top is still slightly wet (custardy), sprinkle Cheese and Onions on ONE HALF of the circle only.", "note": "Don't overfill it." }, { "number": 5, "title": "The Fold", "color": "e1orange", "desc": "Slide spatula under the empty half. Fold it over the cheese half. Press down gently. Serve immediately.", "note": "Residual heat finishes the cooking.", "icon": "check-circle" } ] },
          { "id": "rainbow-fruit-salad", "title": "Rainbow Logic Salad", "subtitle": "Knife Skills Mission", "desc": "Practice safe cutting techniques and color theory. No cooking required.", "level": "Beginner", "color": "e1green", "meta": [ { "label": "Prep", "value": "20m", "icon": "clock" }, { "label": "Cook", "value": "0m", "icon": "slash" }, { "label": "Yield", "value": "1 Bowl", "icon": "utensils" } ], "loadout": [ { "groupName": "The Spectrum", "groupColor": "text-e1pink", "items": ["Red: Strawberries", "Green: Kiwi or Grapes", "Yellow: Mango or Banana"] }, { "groupName": "The Dressing", "groupColor": "text-e1orange", "items": ["1 Tbsp Honey", "1 tsp Lime Juice", "Fresh Mint Leaves"] } ], "vocab": [ { "word": "Hull (v)", "def": "To remove the green leafy top of a strawberry.", "color": "text-e1pink" }, { "word": "Emulsify (v)", "def": "To mix two liquids (honey & lime) together.", "color": "text-e1orange" }, { "word": "Toss (v)", "def": "To mix salad gently without crushing it.", "color": "text-e1green" } ], "steps": [ { "number": 1, "title": "The Claw Grip", "color": "e1pink", "desc": "Safety First! Curl your fingers like a claw when holding fruit. Cut the strawberries into quarters.", "note": "Knuckles protect fingertips." }, { "number": 2, "title": "Peel & Slice", "color": "e1green", "desc": "Peel the Kiwi/Mango. Slice into bite-sized pieces. Try to make all pieces the same size.", "note": "Uniformity looks professional." }, { "number": 3, "title": "Dressing Chemistry", "color": "e1orange", "desc": "In a small cup, mix Honey and Lime Juice. Stir fast until it becomes a thin syrup.", "note": "Acid (Lime) balances the Sweet (Honey)." }, { "number": 4, "title": "Combine", "color": "e1blue", "desc": "Place all fruit in a large bowl. Pour dressing over the top.", "note": "Don't do this until you are ready to eat." }, { "number": 5, "title": "The Toss", "color": "e1green", "desc": "Use two spoons to gently lift and drop the fruit to coat it in dressing. Top with Mint.", "note": "Avoid mushing the banana!" } ] },
          { "id": "binary-choco-cookies", "title": "Binary Choco-Cookies", "subtitle": "Baking Mission", "desc": "Chemistry in action. Turn dough into crispy-chewy discs of happiness.", "level": "Advanced", "color": "e1blue", "meta": [ { "label": "Prep", "value": "20m", "icon": "clock" }, { "label": "Bake", "value": "12m", "icon": "flame" }, { "label": "Yield", "value": "12 Cookies", "icon": "layers" } ], "loadout": [ { "groupName": "Wet Data", "groupColor": "text-e1orange", "items": ["100g Butter (Soft)", "1/2 Cup Sugar", "1 Egg"] }, { "groupName": "Dry Data", "groupColor": "text-e1blue", "items": ["1.5 Cups Flour", "1/2 tsp Baking Soda", "Choco Chips"] } ], "vocab": [ { "word": "Cream (v)", "def": "To mix butter and sugar until pale and fluffy.", "color": "text-e1orange" }, { "word": "Fold (v)", "def": "Gentle mixing to avoid tough cookies.", "color": "text-e1blue" }, { "word": "Cooling (n)", "def": "The process where cookies harden.", "color": "text-e1pink" } ], "steps": [ { "number": 1, "title": "Creaming Method", "color": "e1orange", "desc": "Mash soft butter and sugar together with a spoon/fork until it looks like light yellow paste.", "note": "This traps air bubbles." }, { "number": 2, "title": "Bind It", "color": "e1blue", "desc": "Add the Egg and Vanilla. Mix until smooth.", "note": "The egg acts as glue." }, { "number": 3, "title": "Dry Integration", "color": "e1green", "desc": "Add Flour and Baking Soda. Mix slowly. Stop when no white powder is left. Add Choco Chips.", "note": "Do not overmix!" }, { "number": 4, "title": "Spacing Logic", "color": "e1pink", "desc": "Scoop balls of dough onto tray. Leave 5cm space between them. They will spread when hot.", "note": "Crowded cookies merge into one giant cookie." }, { "number": 5, "title": "Hardening Phase", "color": "e1blue", "desc": "Bake at 180°C for 10-12 mins. Edges should be brown, center soft. Let them cool on tray.", "note": "They are soft when hot, hard when cold.", "icon": "snowflake" } ] },
          { "id": "brain-freeze-smoothie", "title": "Brain-Boost Smoothie", "subtitle": "Blender Mission", "desc": "High-speed physics. Turn solids into liquids using a vortex.", "level": "Easy", "color": "e1pink", "meta": [ { "label": "Prep", "value": "5m", "icon": "clock" }, { "label": "Blend", "value": "30s", "icon": "zap" }, { "label": "Yield", "value": "1 Glass", "icon": "utensils" } ], "loadout": [ { "groupName": "The Base", "groupColor": "text-e1pink", "items": ["1 Frozen Banana", "1/2 Cup Berries", "1 Cup Milk/Soy"] }, { "groupName": "The Boost", "groupColor": "text-e1green", "items": ["1 Tbsp Yogurt", "1 tsp Honey", "Oats (Optional)"] } ], "vocab": [ { "word": "Pulse (v)", "def": "Short bursts of power to break ice.", "color": "text-e1pink" }, { "word": "Vortex (n)", "def": "The tornado shape inside the blender.", "color": "text-e1blue" }, { "word": "Viscosity (n)", "def": "How thick a liquid is.", "color": "text-e1orange" } ], "steps": [ { "number": 1, "title": "Loading Order", "color": "e1blue", "desc": "Pour Milk in FIRST. Then add soft stuff (Yogurt). Add Frozen Fruit LAST.", "note": "Liquids at the bottom help blades spin." }, { "number": 2, "title": "Security Check", "color": "e1orange", "desc": "Put the lid on tight. Hold the lid down with your hand.", "note": "Exploding smoothies make a huge mess." }, { "number": 3, "title": "Pulse Phase", "color": "e1pink", "desc": "Press 'Pulse' 3 times to break the big frozen chunks.", "note": "Listen to the crunch." }, { "number": 4, "title": "Vortex Phase", "color": "e1green", "desc": "Turn to High speed. Watch for the 'Vortex' (tornado) in the middle. Blend for 20 seconds.", "note": "Stop when color is uniform." }, { "number": 5, "title": "Texture Check", "color": "e1blue", "desc": "If it's too thick, add a splash of milk and blend again. Pour and drink immediately.", "note": "Brain freeze warning!", "icon": "thermometer" } ] }
        ];

        let recipes = [];

        async function initApp() {
            // Smart Path Detection
            const possiblePaths = ['./recipes.json', 'recipes.json', '/cookbook/recipes.json'];
            let loaded = false;

            for (const path of possiblePaths) {
                try {
                    const response = await fetch(path);
                    if (response.ok) {
                        recipes = await response.json();
                        loaded = true;
                        break;
                    }
                } catch (e) { console.log(`Path skipped: ${path}`); }
            }

            if (!loaded) {
                recipes = BACKUP_RECIPES;
                console.log("Using Embedded Backup Data");
            }
            
            // Artificial delay removed for snapiness on Chromebook
            renderHome();
        }

        // --- RENDER HOME ---
        function renderHome() {
            const container = document.getElementById('app-container');
            
            if(recipes.length === 0) {
                container.innerHTML = '<div class="text-center p-10 font-fredoka text-xl text-slate-400">Database Empty</div>';
                return;
            }

            const cardsHTML = recipes.map((r, index) => {
                const colors = { e1pink: 'bg-e1pink', e1orange: 'bg-e1orange', e1green: 'bg-e1green', e1blue: 'bg-e1blue' };
                const btnClass = `${colors[r.color] || 'bg-e1dark'} hover:brightness-110`;
                
                return `
                <div class="bg-white border-2 border-e1dark rounded-2xl shadow-neo p-5 flex flex-col justify-between card-neo animate-pop h-full hover:z-10 relative" style="animation-delay: ${index * 40}ms">
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <span class="bg-slate-50 border border-slate-200 px-2 py-1 rounded-md font-bold text-[10px] uppercase tracking-wider text-slate-500">${r.subtitle}</span>
                            <span class="text-[10px] font-black bg-e1dark text-white px-2 py-1 rounded-md">${r.level}</span>
                        </div>
                        <h2 class="font-fredoka text-2xl md:text-3xl font-bold text-e1dark mb-2 leading-tight">${r.title}</h2>
                        <p class="font-nunito text-slate-600 mb-4 text-sm md:text-base font-semibold leading-relaxed line-clamp-2">${r.desc}</p>
                    </div>
                    <div class="mt-auto pt-4 border-t border-dashed border-slate-200 flex items-center justify-between">
                         <div class="flex items-center gap-1.5 text-xs font-bold text-slate-500 bg-slate-100 px-2.5 py-1 rounded-full">
                            <i data-lucide="clock" class="w-3.5 h-3.5"></i> ${(r.meta && r.meta[0]) ? r.meta[0].value : '??'}
                        </div>
                        <button onclick="renderRecipe('${r.id}')" class="${btnClass} text-white font-fredoka font-bold px-5 py-2 rounded-lg border-b-4 border-r-4 border-e1dark active:border-0 btn-neo flex items-center gap-1.5 text-sm md:text-base">
                            OPEN <i data-lucide="arrow-right" class="w-4 h-4"></i>
                        </button>
                    </div>
                </div>
                `;
            }).join('');

            container.innerHTML = `
                <div class="animate-pop">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5 md:gap-6 lg:gap-8">
                        ${cardsHTML}
                    </div>
                </div>
            `;
            window.scrollTo(0,0);
            lucide.createIcons();
        }

        // --- RENDER RECIPE ---
        function renderRecipe(id) {
            const r = recipes.find(recipe => recipe.id === id);
            if (!r) return;
            const container = document.getElementById('app-container');

            // Compact Meta
            let metaHTML = (r.meta || []).map((m) => `
                <div class="bg-white border-2 border-e1dark rounded-lg p-2 text-center shadow-sm min-w-[70px]">
                    <i data-lucide="${m.icon}" class="mx-auto w-4 h-4 text-${r.color} mb-1"></i>
                    <span class="block font-bold text-[10px] uppercase text-slate-400">${m.label}</span>
                    <span class="font-fredoka text-sm font-bold text-e1dark">${m.value}</span>
                </div>
            `).join('');

            let ingredientsHTML = (r.loadout || []).map(group => `
                <div class="mb-5 last:mb-0">
                    <h3 class="font-fredoka text-sm ${group.groupColor} uppercase tracking-wider mb-2 border-b-2 border-slate-200 inline-block pr-2">${group.groupName}</h3>
                    <ul class="space-y-2 text-sm font-bold text-slate-700">
                        ${group.items.map((item, idx) => `
                            <li class="flex items-start gap-2 cursor-pointer select-none hover:bg-slate-50 p-1 rounded transition-colors">
                                <input type="checkbox" id="${group.groupName}-${idx}" class="ingredient-check w-4 h-4 border-2 border-e1dark rounded text-e1green focus:ring-0 mt-0.5 cursor-pointer accent-e1green">
                                <label for="${group.groupName}-${idx}" class="cursor-pointer flex-1">${item}</label>
                            </li>
                        `).join('')}
                    </ul>
                </div>
            `).join('');

            let stepsHTML = (r.steps || []).map((step, idx) => {
                let theme = { bg: 'bg-slate-50', border: 'border-slate-300', text: 'text-slate-600' };
                if(step.color === 'e1blue') theme = { bg: 'bg-blue-50', border: 'border-blue-300', text: 'text-blue-800' };
                if(step.color === 'e1orange') theme = { bg: 'bg-orange-50', border: 'border-orange-300', text: 'text-orange-800' };
                if(step.color === 'e1green') theme = { bg: 'bg-green-50', border: 'border-green-300', text: 'text-green-800' };
                if(step.color === 'e1pink') theme = { bg: 'bg-pink-50', border: 'border-pink-300', text: 'text-pink-800' };

                return `
                <div class="bg-white border-l-4 border-t-2 border-r-2 border-b-2 border-e1dark rounded-xl shadow-sm p-5 flex gap-4 hover:shadow-md transition-shadow mb-4">
                    <div class="hidden md:flex bg-e1chalk border-2 border-e1dark w-12 h-12 rounded-lg items-center justify-center flex-shrink-0">
                        <span class="font-fredoka text-2xl font-bold text-e1dark">${step.number}</span>
                    </div>
                    <div class="w-full">
                        <div class="flex items-center gap-2 mb-1">
                             <span class="md:hidden font-fredoka text-sm font-bold bg-e1dark text-white w-6 h-6 rounded flex items-center justify-center">${step.number}</span>
                             <h3 class="font-fredoka text-xl font-bold text-${step.color}">${step.title}</h3>
                        </div>
                        <p class="text-slate-700 text-base font-semibold mb-3 leading-relaxed">${step.desc}</p>
                        <div class="${theme.bg} border-l-4 ${theme.border} p-3 rounded-r-lg text-sm ${theme.text} flex items-start gap-2">
                            ${step.icon ? `<i data-lucide="${step.icon}" class="w-4 h-4 mt-0.5 flex-shrink-0"></i>` : ''}
                            <span class="font-bold">${step.note}</span>
                        </div>
                    </div>
                </div>`;
            }).join('');

            container.innerHTML = `
                <div class="animate-pop pb-12">
                    <button onclick="renderHome()" class="mb-4 flex items-center gap-2 font-bold text-slate-500 hover:text-e1dark transition-colors group text-sm">
                        <div class="bg-white border border-slate-300 p-1.5 rounded-md group-hover:border-e1dark group-hover:shadow-sm transition-all">
                            <i data-lucide="arrow-left" class="w-4 h-4"></i>
                        </div>
                        <span class="font-fredoka">Back to Menu</span>
                    </button>

                    <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
                        <div class="lg:col-span-12 bg-white border-2 border-e1dark shadow-neo rounded-xl p-5 md:p-6 flex flex-col md:flex-row justify-between items-center gap-4 relative overflow-hidden">
                            <div class="absolute top-0 left-0 w-full h-2 bg-${r.color}"></div>
                            <div class="w-full relative z-10 pt-2">
                                <span class="bg-${r.color} text-white font-fredoka font-bold px-2 py-0.5 border border-e1dark rounded text-xs mb-2 inline-block uppercase shadow-sm">ID: ${r.id}</span>
                                <h1 class="font-fredoka text-3xl md:text-5xl font-bold text-e1dark mb-1">${r.title}</h1>
                                <p class="font-nunito text-lg text-slate-600 font-bold">${r.subtitle}</p>
                            </div>
                            <div class="flex gap-2 flex-wrap justify-center md:justify-end relative z-10">
                                ${metaHTML}
                            </div>
                        </div>

                        <div class="lg:col-span-4 space-y-4 h-fit">
                            <div class="bg-white border-2 border-e1dark rounded-xl shadow-neo overflow-hidden">
                                <div class="bg-e1dark p-3 flex justify-between items-center">
                                    <h2 class="font-fredoka text-lg font-bold text-white flex items-center gap-2"><i data-lucide="shopping-bag" class="w-4 h-4"></i> Loadout</h2>
                                </div>
                                <div class="p-4 bg-[url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0IiBoZWlnaHQ9IjQiPgo8cmVjdCB3aWR0aD0iNCIgaGVpZ2h0PSI0IiBmaWxsPSIjZmZmZmZmIi8+CjxyZWN0IHdpZHRoPSIxIiBoZWlnaHQ9IjEiIGZpbGw9IiNmMmYyZjIiLz4KPC9zdmc+')]">
                                    ${ingredientsHTML}
                                </div>
                            </div>
                            
                            <div class="bg-e1chalk border-2 border-slate-300 rounded-xl shadow-sm p-4 text-e1dark">
                                <h3 class="font-fredoka text-lg text-e1blue mb-3 flex items-center gap-2 border-b border-slate-200 pb-2"><i data-lucide="book-open" class="w-4 h-4"></i> Vocab Check</h3>
                                <ul class="space-y-2">
                                    ${(r.vocab || []).map(v => `<li class="bg-white border border-slate-200 p-2 rounded-lg text-sm"><span class="${v.color} font-fredoka font-bold block">${v.word}</span> <span class="text-slate-500 font-semibold">${v.def}</span></li>`).join('')}
                                </ul>
                            </div>
                        </div>

                        <div class="lg:col-span-8">
                            ${stepsHTML}
                            <div class="mt-8 text-center p-6 border-2 border-dashed border-slate-300 rounded-xl bg-slate-50/50">
                                <h3 class="font-fredoka text-xl text-slate-400 font-bold mb-1">Mission Complete?</h3>
                                <p class="text-sm text-slate-500 font-bold">Show your result to the teacher!</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            window.scrollTo(0,0);
            lucide.createIcons();
        }

        initApp();
    </script>
</body>
</html>