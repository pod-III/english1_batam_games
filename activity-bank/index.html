<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>English 1 Activity Bank</title>

        <!-- Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300..700&family=Nunito:wght@400;600;700;800&display=swap"
            rel="stylesheet"
        />

        <!-- Tailwind CSS -->
        <script src="https://cdn.tailwindcss.com"></script>

        <!-- Lucide Icons -->
        <script src="https://unpkg.com/lucide@latest"></script>

        <!-- Tailwind Config -->
        <script>
            tailwind.config = {
                darkMode: "class",
                theme: {
                    extend: {
                        colors: {
                            engPink: "#FF6B95",
                            engOrange: "#FF8C42",
                            engGreen: "#00E676",
                            engBlue: "#2979FF",
                            engDark: "#1e293b",
                            engChalk: "#f8fafc",
                        },
                        fontFamily: {
                            headings: ["Fredoka", "sans-serif"],
                            body: ["Nunito", "sans-serif"],
                        },
                        boxShadow: {
                            neo: "4px 4px 0px 0px rgba(30, 41, 59, 1)",
                            "neo-sm": "2px 2px 0px 0px rgba(30, 41, 59, 1)",
                            "neo-lg": "8px 8px 0px 0px rgba(30, 41, 59, 1)",
                        },
                    },
                },
            };
        </script>

        <style>
            /* Graph Paper Background Pattern */
            .bg-graph {
                background-color: #f8fafc;
                background-image:
                    linear-gradient(#e2e8f0 1px, transparent 1px),
                    linear-gradient(90deg, #e2e8f0 1px, transparent 1px);
                background-size: 24px 24px;
            }

            .dark .bg-graph {
                background-color: #0f172a;
                background-image:
                    linear-gradient(#1e293b 1px, transparent 1px),
                    linear-gradient(90deg, #1e293b 1px, transparent 1px);
            }

            /* Interactive Elements */
            .btn-neo {
                transition: all 0.1s cubic-bezier(0.4, 0, 0.2, 1);
            }
            .btn-neo:active {
                transform: translate(2px, 2px);
                box-shadow: 0px 0px 0px 0px rgba(30, 41, 59, 1);
            }
            .btn-neo:hover {
                transform: translate(-1px, -1px);
                box-shadow: 5px 5px 0px 0px rgba(30, 41, 59, 1);
            }

            /* Card Hover Effect */
            .card-hover {
                transition:
                    transform 0.2s ease,
                    box-shadow 0.2s ease;
            }
            .card-hover:hover {
                transform: translateY(-4px);
                box-shadow: 6px 6px 0px 0px rgba(30, 41, 59, 1);
            }

            /* Toast Animation */
            @keyframes slideUp {
                from {
                    transform: translate(-50%, 100%);
                    opacity: 0;
                }
                to {
                    transform: translate(-50%, 0);
                    opacity: 1;
                }
            }
            .toast {
                animation: slideUp 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
                    forwards;
            }

            /* Modal Animation */
            dialog[open] {
                animation: fadeIn 0.2s ease-out;
            }
            @keyframes fadeIn {
                from {
                    opacity: 0;
                    transform: scale(0.95);
                }
                to {
                    opacity: 1;
                    transform: scale(1);
                }
            }
            dialog::backdrop {
                background: rgba(30, 41, 59, 0.5);
                backdrop-filter: blur(2px);
            }

            /* Staggered Entry for Cards */
            @keyframes fadeInUp {
                from {
                    opacity: 0;
                    transform: translateY(20px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
            .card-enter {
                animation: fadeInUp 0.4s ease-out forwards;
            }
        </style>
    </head>
    <body
        class="bg-graph text-engDark font-body min-h-screen p-4 md:p-8 selection:bg-engPink selection:text-white transition-colors duration-300"
    >
        <!-- Header -->
        <header
            class="max-w-7xl mx-auto mb-8 flex flex-col md:flex-row justify-between items-center gap-6"
        >
            <div class="text-center md:text-left">
                <h1
                    class="font-headings text-4xl md:text-6xl font-bold tracking-wide text-engDark"
                >
                    <span
                        class="bg-engPink text-white px-6 py-2 rounded-2xl border-4 border-engDark shadow-neo inline-block -rotate-2 hover:rotate-0 transition-transform cursor-default"
                        >Activity</span
                    >
                    <span
                        class="bg-engBlue text-white px-6 py-2 rounded-2xl border-4 border-engDark shadow-neo inline-block rotate-2 hover:rotate-0 transition-transform cursor-default"
                        >Bank</span
                    >
                </h1>
            </div>

            <div class="flex gap-4">
                <!-- Dark Mode Toggle -->
                <button
                    onclick="toggleTheme()"
                    class="btn-neo bg-white dark:bg-slate-800 p-3 rounded-xl border-4 border-engDark shadow-neo"
                    aria-label="Toggle Dark Mode"
                >
                    <i
                        data-lucide="moon"
                        class="w-6 h-6 text-engDark dark:hidden"
                    ></i>
                    <i
                        data-lucide="sun"
                        class="w-6 h-6 text-engOrange hidden dark:block"
                    ></i>
                </button>
            </div>
        </header>

        <!-- Controls Section -->
        <section class="max-w-7xl mx-auto mb-12 sticky top-4 z-30">
            <div
                class="bg-white/90 dark:bg-slate-800/90 backdrop-blur-md border-4 border-engDark rounded-2xl p-4 shadow-neo flex flex-col md:flex-row gap-4 items-center justify-between"
            >
                <!-- Filter Buttons -->
                <div
                    class="flex flex-wrap justify-center gap-3 w-full md:w-auto"
                    id="filter-container"
                >
                    <button
                        onclick="filterActivities('all')"
                        class="filter-btn active btn-neo font-headings font-bold bg-engDark text-white px-5 py-2 rounded-xl border-2 border-engDark shadow-neo-sm ring-offset-2 focus:ring-2"
                    >
                        All
                    </button>
                    <button
                        onclick="filterActivities('Stirrer')"
                        class="filter-btn btn-neo font-headings font-bold bg-engChalk text-engDark px-5 py-2 rounded-xl border-2 border-engDark shadow-neo-sm flex items-center gap-2 hover:bg-engOrange hover:text-white transition-colors"
                    >
                        <i data-lucide="zap" class="w-4 h-4"></i> Stirrers
                    </button>
                    <button
                        onclick="filterActivities('Settler')"
                        class="filter-btn btn-neo font-headings font-bold bg-engChalk text-engDark px-5 py-2 rounded-xl border-2 border-engDark shadow-neo-sm flex items-center gap-2 hover:bg-engBlue hover:text-white transition-colors"
                    >
                        <i data-lucide="anchor" class="w-4 h-4"></i> Settlers
                    </button>
                </div>

                <!-- Search Bar -->
                <div class="relative w-full md:w-96 group">
                    <i
                        data-lucide="search"
                        class="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400 group-focus-within:text-engPink transition-colors"
                    ></i>
                    <input
                        type="text"
                        id="searchInput"
                        placeholder="Search skills, titles..."
                        class="w-full pl-12 pr-4 py-3 border-4 border-engDark rounded-xl font-bold bg-engChalk dark:bg-slate-700 dark:text-white focus:outline-none focus:border-engPink focus:shadow-[0_0_0_4px_rgba(255,107,149,0.3)] transition-all placeholder:font-semibold"
                    />
                </div>
            </div>
        </section>

        <!-- Grid Container -->
        <main
            id="activitiesGrid"
            class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 pb-20"
        >
            <!-- Content injected via JS -->
            <div class="col-span-full text-center py-20 animate-pulse">
                <div
                    class="inline-block p-4 rounded-full bg-slate-100 dark:bg-slate-800 mb-4"
                >
                    <i
                        data-lucide="loader"
                        class="w-8 h-8 text-engBlue animate-spin"
                    ></i>
                </div>
                <p class="font-bold text-slate-400">
                    Loading your activities...
                </p>
            </div>
        </main>

        <!-- Empty State -->
        <div id="emptyState" class="hidden text-center py-20">
            <div
                class="inline-block p-6 rounded-full bg-slate-200 border-4 border-engDark mb-4"
            >
                <i data-lucide="frown" class="w-12 h-12 text-slate-500"></i>
            </div>
            <h3 class="font-headings text-2xl font-bold text-slate-600">
                No activities found.
            </h3>
            <p class="text-slate-500 font-bold mt-2">
                Try adjusting your filters or search terms.
            </p>
        </div>

        <!-- Guide Modal -->
        <dialog
            id="guideModal"
            class="p-0 rounded-2xl border-4 border-engDark shadow-neo-lg bg-transparent backdrop:bg-slate-900/50 w-full max-w-2xl m-auto"
        >
            <div class="bg-white dark:bg-slate-800 flex flex-col max-h-[90vh]">
                <!-- Modal Header -->
                <div
                    id="modalHeader"
                    class="p-6 border-b-4 border-engDark flex justify-between items-center bg-engChalk dark:bg-slate-900"
                >
                    <h2
                        id="modalTitle"
                        class="font-headings text-3xl font-bold text-engDark dark:text-white"
                    >
                        Activity Title
                    </h2>
                    <button
                        onclick="closeModal()"
                        class="btn-neo bg-white dark:bg-slate-700 p-2 rounded-xl border-2 border-engDark hover:bg-slate-100"
                    >
                        <i
                            data-lucide="x"
                            class="w-6 h-6 text-engDark dark:text-white"
                        ></i>
                    </button>
                </div>

                <!-- Modal Body -->
                <div class="p-8 overflow-y-auto">
                    <div class="flex gap-4 mb-6">
                        <span
                            id="modalType"
                            class="px-3 py-1 rounded-lg border-2 border-engDark font-bold text-sm bg-slate-200"
                            >Type</span
                        >
                        <span
                            id="modalTime"
                            class="px-3 py-1 rounded-lg border-2 border-engDark font-bold text-sm bg-slate-200"
                            >Time</span
                        >
                        <span
                            id="modalDiff"
                            class="px-3 py-1 rounded-lg border-2 border-engDark font-bold text-sm bg-slate-200"
                            >Diff</span
                        >
                    </div>

                    <div class="mb-8">
                        <h3
                            class="font-headings text-xl font-bold text-engBlue mb-3 flex items-center gap-2"
                        >
                            <i data-lucide="list-checks" class="w-5 h-5"></i>
                            Steps
                        </h3>
                        <ul
                            id="modalSteps"
                            class="space-y-3 text-slate-700 dark:text-slate-300 font-medium list-none"
                        >
                            <!-- Steps injected here -->
                        </ul>
                    </div>

                    <div
                        class="bg-engOrange/10 border-l-4 border-engOrange p-4 rounded-r-xl"
                    >
                        <h3
                            class="font-headings text-lg font-bold text-engOrange mb-2 flex items-center gap-2"
                        >
                            <i data-lucide="lightbulb" class="w-5 h-5"></i>
                            Teacher Tip / Variation
                        </h3>
                        <p
                            id="modalVariation"
                            class="text-slate-700 dark:text-slate-300 text-sm italic"
                        >
                            <!-- Variation injected here -->
                        </p>
                    </div>
                </div>

                <!-- Modal Footer -->
                <div
                    class="p-6 border-t-4 border-engDark bg-slate-50 dark:bg-slate-900 flex justify-end"
                >
                    <button
                        onclick="closeModal()"
                        class="btn-neo bg-engDark text-white font-headings font-bold px-8 py-3 rounded-xl border-2 border-engDark shadow-neo"
                    >
                        Got it!
                    </button>
                </div>
            </div>
        </dialog>

        <!-- Toast Notification -->
        <div
            id="toast"
            class="fixed bottom-10 left-1/2 transform -translate-x-1/2 hidden bg-engDark text-white px-6 py-3 rounded-xl border-2 border-engGreen shadow-neo font-bold z-50 flex items-center gap-2"
        >
            <i data-lucide="check-circle" class="w-5 h-5 text-engGreen"></i>
            Copied to clipboard!
        </div>

        <!-- JavaScript Logic -->
        <script>
            // Global state variable
            let activities = [];

            // --- FETCH LOGIC ---
            async function fetchActivities() {
                const grid = document.getElementById("activitiesGrid");
                try {
                    const response = await fetch("activities.json");
                    if (!response.ok) {
                        throw new Error(
                            `HTTP error! status: ${response.status}`,
                        );
                    }
                    activities = await response.json();
                    renderActivities(activities);
                    lucide.createIcons(); // Re-init icons after render
                } catch (error) {
                    console.error("Error loading activities:", error);
                    grid.innerHTML = `
                    <div class="col-span-full text-center py-10 bg-red-50 dark:bg-red-900/20 rounded-2xl border-2 border-red-200">
                        <i data-lucide="alert-triangle" class="w-10 h-10 text-red-500 mx-auto mb-2"></i>
                        <p class="font-bold text-red-600 dark:text-red-400">Failed to load activities.</p>
                        <p class="text-sm text-red-400 mt-1">Make sure 'activities.json' is in the same folder.</p>
                    </div>
                `;
                    lucide.createIcons();
                }
            }

            // --- RENDER LOGIC ---
            const grid = document.getElementById("activitiesGrid");
            const emptyState = document.getElementById("emptyState");
            const searchInput = document.getElementById("searchInput");
            const modal = document.getElementById("guideModal");

            function getDifficultyInfo(level) {
                switch (level) {
                    case "Easy":
                        return {
                            class: "bg-engGreen/20 text-engGreen border-engGreen",
                            color: "#00E676",
                        };
                    case "Medium":
                        return {
                            class: "bg-engOrange/20 text-engOrange border-engOrange",
                            color: "#FF8C42",
                        };
                    case "Hard":
                        return {
                            class: "bg-engPink/20 text-engPink border-engPink",
                            color: "#FF6B95",
                        };
                    default:
                        return {
                            class: "bg-slate-200 text-slate-600 border-slate-400",
                            color: "#cbd5e1",
                        };
                }
            }

            function renderActivities(data) {
                grid.innerHTML = "";

                if (data.length === 0) {
                    emptyState.classList.remove("hidden");
                    return;
                } else {
                    emptyState.classList.add("hidden");
                }

                data.forEach((activity, index) => {
                    const isStirrer = activity.type === "Stirrer";
                    const headerColor = isStirrer
                        ? "bg-engOrange"
                        : "bg-engBlue";
                    const iconType = isStirrer ? "zap" : "anchor";
                    const diffInfo = getDifficultyInfo(activity.difficulty);

                    const card = document.createElement("article");
                    // Added stagger animation class
                    card.style.animationDelay = `${index * 50}ms`;
                    card.className =
                        "card-enter card-hover bg-white dark:bg-slate-800 rounded-2xl border-4 border-engDark shadow-neo overflow-hidden flex flex-col h-full relative group";

                    const skillsHtml = activity.skills
                        .map((skill) => {
                            return `<span class="px-2 py-1 rounded-md border-2 border-engDark/10 bg-slate-100 dark:bg-slate-700 text-engDark dark:text-slate-300 font-bold text-[11px] uppercase tracking-wider">${skill}</span>`;
                        })
                        .join("");

                    card.innerHTML = `
                    <div class="${headerColor} p-4 border-b-4 border-engDark flex justify-between items-center relative overflow-hidden">
                        <div class="absolute inset-0 bg-white/10 opacity-0 group-hover:opacity-100 transition-opacity"></div>

                        <!-- Left: Type -->
                        <span class="font-headings font-bold text-white text-lg flex items-center gap-2 relative z-10">
                            <i data-lucide="${iconType}" class="w-5 h-5"></i> ${activity.type.toUpperCase()}
                        </span>

                        <!-- Right: Meta Data Group -->
                        <div class="flex gap-2 relative z-10">
                             <!-- Difficulty Badge (New Location) -->
                             <span class="bg-white text-engDark text-xs font-black px-2 py-1 rounded-lg border-2 border-engDark uppercase shadow-sm">
                                ${activity.difficulty}
                            </span>
                             <!-- Time Badge -->
                             <span class="bg-white/20 text-white text-xs font-bold px-2 py-1 rounded-lg border-2 border-transparent flex items-center">
                                ${activity.time}
                            </span>
                        </div>
                    </div>

                    <div class="p-6 flex-grow flex flex-col relative">
                        <div class="mb-4 flex items-start justify-between">
                            <h2 class="font-headings text-2xl font-bold text-engDark dark:text-white leading-tight mr-2">${activity.title}</h2>
                            <!-- Icon specific to activity -->
                            <div class="p-2 rounded-xl bg-slate-50 dark:bg-slate-700 border-2 border-engDark/10">
                                <i data-lucide="${activity.icon}" class="w-6 h-6 text-slate-400 dark:text-slate-300"></i>
                            </div>
                        </div>

                        <p class="text-slate-600 dark:text-slate-300 font-medium mb-6 text-sm leading-relaxed flex-grow">
                            ${activity.desc}
                        </p>

                        <div class="mt-auto pt-4 border-t-2 border-dashed border-slate-200 dark:border-slate-700">
                            <div class="flex flex-wrap gap-2">
                                ${skillsHtml}
                            </div>
                        </div>
                    </div>

                    <div class="p-4 bg-slate-50 dark:bg-slate-900 border-t-4 border-engDark flex gap-3">
                         <button onclick="copyToClipboard('${activity.desc.replace(/'/g, "\\'")}')" class="btn-neo w-12 h-12 flex-shrink-0 bg-white dark:bg-slate-800 text-engDark dark:text-white rounded-xl border-2 border-engDark shadow-neo flex justify-center items-center group/btn hover:bg-slate-100 dark:hover:bg-slate-700" title="Copy Description">
                            <i data-lucide="copy" class="w-5 h-5 group-hover/btn:scale-110 transition-transform"></i>
                        </button>
                        <button onclick="openModal(${activity.id})" class="flex-grow btn-neo bg-engDark text-white font-headings font-bold py-2 rounded-xl border-2 border-engDark shadow-neo flex justify-center items-center gap-2 group/btn">
                            View Guide <i data-lucide="arrow-right" class="w-4 h-4 group-hover/btn:translate-x-1 transition-transform"></i>
                        </button>
                    </div>
                `;

                    grid.appendChild(card);
                });

                lucide.createIcons();
            }

            // --- MODAL LOGIC ---
            function openModal(id) {
                const act = activities.find((a) => a.id === id);
                if (!act) return;

                // Populate Text
                document.getElementById("modalTitle").innerText = act.title;
                document.getElementById("modalVariation").innerText =
                    act.variation;

                // Populate Badges
                const typeBadge = document.getElementById("modalType");
                typeBadge.innerText = act.type;
                typeBadge.className = `px-3 py-1 rounded-lg border-2 border-engDark font-bold text-sm text-white ${act.type === "Stirrer" ? "bg-engOrange" : "bg-engBlue"}`;

                document.getElementById("modalTime").innerText = act.time;

                const diffInfo = getDifficultyInfo(act.difficulty);
                const diffBadge = document.getElementById("modalDiff");
                diffBadge.innerText = act.difficulty;
                diffBadge.className = `px-3 py-1 rounded-lg border-2 border-engDark font-bold text-sm ${diffInfo.class}`;

                // Populate Steps
                const stepsList = document.getElementById("modalSteps");
                stepsList.innerHTML = act.steps
                    .map(
                        (step, i) => `
                <li class="flex gap-3 items-start">
                    <span class="flex-shrink-0 w-8 h-8 rounded-full bg-engDark text-white flex items-center justify-center font-bold text-sm border-2 border-engDark">${i + 1}</span>
                    <span class="mt-1">${step}</span>
                </li>
            `,
                    )
                    .join("");

                // Show Modal
                modal.showModal();
            }

            function closeModal() {
                // Add close animation class if desired, or just close
                modal.close();
            }

            // Close modal when clicking outside
            modal.addEventListener("click", (e) => {
                const rect = modal.getBoundingClientRect();
                const isInDialog =
                    rect.top <= e.clientY &&
                    e.clientY <= rect.top + rect.height &&
                    rect.left <= e.clientX &&
                    e.clientX <= rect.left + rect.width;
                if (!isInDialog) {
                    modal.close();
                }
            });

            // --- CLIPBOARD LOGIC ---
            function copyToClipboard(text) {
                const textarea = document.createElement("textarea");
                textarea.value = text;
                textarea.setAttribute("readonly", "");
                textarea.style.position = "absolute";
                textarea.style.left = "-9999px";
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand("copy");
                document.body.removeChild(textarea);
                showToast();
            }

            function showToast() {
                const toast = document.getElementById("toast");
                toast.classList.remove("hidden");
                toast.classList.add("toast");
                setTimeout(() => {
                    toast.classList.add("hidden");
                    toast.classList.remove("toast");
                }, 2500);
            }

            // --- FILTER LOGIC ---
            let currentFilter = "all";
            let currentSearch = "";

            function applyFilters() {
                const filtered = activities.filter((act) => {
                    const matchesCategory =
                        currentFilter === "all" || act.type === currentFilter;
                    const searchLower = currentSearch.toLowerCase();
                    const matchesSearch =
                        act.title.toLowerCase().includes(searchLower) ||
                        act.skills.some((s) =>
                            s.toLowerCase().includes(searchLower),
                        );
                    return matchesCategory && matchesSearch;
                });
                renderActivities(filtered);
            }

            function filterActivities(category) {
                currentFilter = category;
                const buttons = document.querySelectorAll(".filter-btn");
                buttons.forEach((btn) => {
                    btn.classList.remove("bg-engDark", "text-white");
                    btn.classList.add("bg-engChalk", "text-engDark");
                    if (
                        (category === "all" &&
                            btn.innerText.trim() === "All") ||
                        (category !== "all" &&
                            btn.innerText.includes(category + "s"))
                    ) {
                        btn.classList.remove("bg-engChalk", "text-engDark");
                        btn.classList.add("bg-engDark", "text-white");
                    }
                });
                applyFilters();
            }

            // --- EVENT LISTENERS ---
            searchInput.addEventListener("input", (e) => {
                currentSearch = e.target.value;
                applyFilters();
            });

            function toggleTheme() {
                document.documentElement.classList.toggle("dark");
            }

            // --- INIT ---
            window.onload = () => {
                fetchActivities();
                // Lucide icons are re-initialized in the fetch function
            };
        </script>
    </body>
</html>
